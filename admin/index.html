<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - ZDFinance</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="header">
        <h1><a href="index.html">ZDFinance</a></h1>
        <h3>Admin WebPage (God mode)</h3>
    </div>
    <div class="sidebar">
        <h2>Navigation</h2>
        <a href="read_clients.php">Display Users</a>
        <a href="read_accounts.php">Display Accounts</a>
        <a href="read_cards.php">Display Cards</a>
        <a href="read_transactions_ext.php">External Transactions</a>
        <a href="read_transactions_int.php">Internal Transactions</a>
        <a href="read_audit_logs.php">Audit Logs</a>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <h2>Admin Dashboard</h2>
        <div class="chart-container">
            <h3>Users Status Distribution</h3>
            <canvas id="usersChart"></canvas>
        </div>
        <div class="chart-container">
            <h3>Account Balances Distribution</h3>
            <canvas id="accountsChart"></canvas>
        </div>
        <div class="chart-container">
            <h3>Transaction Types</h3>
            <canvas id="transactionsChart"></canvas>
        </div>
    </div>

    <script>
        // Fetch data from the server
        fetch('get_chart_data.php')
            .then(response => response.json())
            .then(data => {
                // Parse the response
                const usersData = {
                    labels: data.users_status_data.map(item => item.label),
                    datasets: [{
                        data: data.users_status_data.map(item => item.count),
                        backgroundColor: ['#007bff', '#dc3545'],
                    }]
                };

                const accountsData = {
                    labels: data.account_balances_data.map(item => item.label),
                    datasets: [{
                        data: data.account_balances_data.map(item => item.count),
                        backgroundColor: ['#007bff', '#ffc107', '#28a745'],
                    }]
                };

                const transactionsData = {
                    labels: data.transaction_types_data.map(item => item.label),
                    datasets: [{
                        data: data.transaction_types_data.map(item => item.count),
                        backgroundColor: ['#17a2b8', '#28a745'],
                    }]
                };

                // Render charts
                new Chart(document.getElementById('usersChart'), {
                    type: 'pie',
                    data: usersData,
                });

                new Chart(document.getElementById('accountsChart'), {
                    type: 'bar',
                    data: accountsData,
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { position: 'top' },
                            title: { display: true, text: 'Account Balances' }
                        }
                    }
                });

                new Chart(document.getElementById('transactionsChart'), {
                    type: 'doughnut',
                    data: transactionsData,
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    </script>
</body>
</html>
